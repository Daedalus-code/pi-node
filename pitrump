#!/bin/bash

# By Rainman
# V20222601
# 0.0.4.3

# setfont for display HyperPixel 4.0, 800×480 (~235 PPI)
sudo setfont /usr/share/consolefonts/Lat7-Terminus24x12.psf.gz &>/dev/null

for (( ; ; )); do # loop dashbord

  source /usr/local/bin/include/color
  source /usr/local/bin/include/functions
  source /usr/local/bin/include/time_fix
  clear
  # dashbord
  printf '%b' "
${N0:?}                       ${RC:?} PiTrump ${N0:?}${VERSION:?} ${GR:?}pitrump${N0:?}         ${CLOCK:?}
${N0:?}                       ${N0:?} TrumpCoin Fullnode             ${TH:?} ${POS_STATUS:?} ${TOR_ICON:?} ${CY:?}${INTERFACE:?}${N0:?}
${RC:?}   #################   ${RC:?} -----------------------------------------${N0:?}
${RC:?}   #################   ${N0:?} Load ${LOAD:?} temp ${CPU_CTEMP:?}°C ${CPU_FTEMP:?}°F
${RC:?}   ##    #####    ##   ${N0:?} Free Mem ${FREE_MEM:?}/${TOTAL_MEM:?} HDDuse ${USED_HDD:?} (${USED_HDD_P:?})
${RC:?}         #####         ${N0:?} ${USER:?}@${IP_ADDRESS:?} ${G0:?}⇩${N0:?} ${DOWNLOAD:?} ${R1:?}⇧${N0:?} ${UPLOAD:?}
${RC:?}         #####         ${N0:?} trumpcoin ${WALLET_VERSION:?} ${WALLET_CHAIN:?} Sync ${WALLET_SYNC:?}
${RC:?}         #####         ${N0:?} WAN ${PUBLIC_IP:?} Peers ${WALLET_PEERS_TOTAL:?} ${WALLET_PEERS_LATEST:?} ${WALLET_PEERS_OTHER:?}
${RC:?}         #####         ${N0:?}
${RC:?}        #######        ${N0:?} Balance ${G0:?}${WALLET_BALANCE:?}${N0:?} Stakes ${G0:?}${WALLET_STAKES:?}${N0:?} Inputs ${G0:?}${WALLET_INPUTS:?}${N0:?}
${RC:?}      ###########      ${N0:?} TxCount ${N0:?}${WALLET_TXCOUNT:?}${N0:?} Mempool ${WALLET_MEMPOOL:?}${N0:?} Block ${WALLET_HEADS:?}${N0:?}
${N0:?}                       ${N0:?} ${TIMELINE:?}
${RC_LOADING:?}${N0:?}
${TX:?} ${WALLET_TXLAST:?}${N0:?}

${LAST_LOG:?}
"

  echo "$(date +%s 2>&1)" >"${LOG_DIR:?}"/node_data/stats/time.dashbord 2>&1 # keep time, remove warden file if no_display is set to 1
  if [[ "$NO_DISPLAY" -eq "1" ]]; then
    rm "${LOG_DIR:?}"/node_data/stats/time.warden &>/dev/null
  fi
  sleep "${TIME:?}"

done

# END
