#!/bin/bash

# By Rainman
# V20220101
# 0.0.4.9

# make sure dialog exist
if ! [ -x "$(command -v dialog)" ] &>/dev/null; then
  sudo apt-get install dialog -y
fi

HEIGHT=8
WIDTH=26
CHOICE_HEIGHT=2
BACKTITLE="Trump-Node"
TITLE="Node Options"
MENU="Choose one of the following options:"

OPTIONS=(1 "Turn off node")

CHOICE=$(dialog --clear \
  --backtitle "$BACKTITLE" \
  --title "$TITLE" \
  --menu "$MENU" \
  $HEIGHT $WIDTH $CHOICE_HEIGHT \
  "${OPTIONS[@]}" \
  2>&1 >/dev/tty)

clear
case $CHOICE in

"1")

  # turn of trumpcoin daemon
  read -r -p "[YN] Turn off daemon, are you sure? y/n " -n 1 -r
  if [[ $REPLY =~ ^[Yy]$ ]] &>/dev/null; then
    kill -9 "$(pidof trumpcoind &>/dev/null)" && sleep 3
    read -r -p "[YN] Reboot? y/n " -n 1 -r
    if [[ $REPLY =~ ^[Yy]$ ]] &>/dev/null; then
      sudo reboot
    fi
  fi
  clear

  ;;

esac

# END
