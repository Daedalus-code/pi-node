#!/bin/bash

# By Rainman
# V20220703
# 0.3.8.3

# shellcheck disable=SC2034  # Unused variables left for readability

########## config ##############################################################

source /usr/local/bin/include/pinode.conf 2>&1
source /usr/local/bin/include/color 2>&1

########## sync_progress_bar ###################################################

# save progress
grep -o "progress=........" "${WALLET_LOG_DIR:?}"/debug.log 2>&1 | egrep -o "[0-9]+.[0-9]+" 2>&1 | tail -1 >"${LOG_DIR:?}"/node_data/client/tmp/proc 2>&1

# when debug.log says wallet is synced, this stops here
if ! grep "progress=" "${WALLET_LOG_DIR:?}"/debug.log 2>&1 | tail -1 2>&1 | grep "progress=1.00" &>/dev/null; then
  # look for 'progress=1' line, save it there and then
  grep "progress=" "${WALLET_LOG_DIR:?}"/debug.log 2>&1 | tail -1 2>&1 | grep "progress=1.00" >"${LOG_DIR:?}"/node_data/synced 2>&1

  # greater than n seconds, continue
  if [[ "$(cat "${LOG_DIR:?}"/node_data/uptime 2>/dev/null)" -gt "1" ]] &>/dev/null; then
    # make sure proc exist
    touch "${LOG_DIR:?}"/node_data/client/tmp/proc &>/dev/null

    # get blockchain sync
    WALLET_SYNC_PROC=$(cat "${LOG_DIR:?}"/node_data/client/tmp/proc 2>/dev/null | sed 's/^0*//' 2>&1 | tr -d '.' 2>&1)

    if [[ -z "$WALLET_SYNC_PROC" ]] &>/dev/null; then
      WALLET_SYNC_PROC="1"
    fi

    SYNCING_REPLACE_TX=$(echo "100/999990*${WALLET_SYNC_PROC:?}" 2>&1 | bc -l 2>&1 | awk '{ printf "%.1f\n", $1 }' 2>&1 | tr -d '.' 2>&1)

    if [[ "$(cat "${LOG_DIR:?}"/node_data/uptime 2>/dev/null)" -gt "300" ]] &>/dev/null; then
      # less than 10%, continue
      if [[ "$SYNCING_REPLACE_TX" -lt "100" ]] &>/dev/null; then
        # remove bootstrap lock
        rm "${WALLET_DIR:?}"/boot &>/dev/null
        printf '%b' "${LOG_DATE:?} Status() Progress.Bar() Reinstall bootstrap${N0:?}\n" >>"${WALLET_LOG_DIR:?}"/debug.log 2>&1
      fi
    fi

    # progress left
    echo "${SYNCING_REPLACE_TX}" >>"${LOG_DIR:?}"/node_data/synced_progress
    PRO_DIFF=$(echo "$(cat "${LOG_DIR:?}"/node_data/synced_progress 2>/dev/null | tail -1 2>&1)-$(cat "${LOG_DIR:?}"/node_data/synced_progress 2>/dev/null | head -1 2>&1)" | bc 2>&1)
    PRO_DIFF_EST=$(echo "${PRO_DIFF:?}/$(wc -l "${LOG_DIR:?}"/node_data/synced_progress | awk '{ print $1 }' 2>&1)" | bc -l 2>&1)
    # minutes left approx
    SYNC_PRO_LEFT=$(echo "1000-$(cat "${LOG_DIR:?}"/node_data/synced_progress 2>/dev/null | wc -l)" 2>&1 | bc -l 2>&1)
    EST_MIN_LEFT=$(echo "${SYNC_PRO_LEFT:?}/${PRO_DIFF_EST:?}" 2>&1 | bc -l 2>&1 | awk '{ printf "%.0f\n", $1 }' 2>&1)

    if [[ "$EST_MIN_LEFT" -eq "0" ]] &>/dev/null; then
      EST_MIN_LEFT="1"
    fi

    # syncing blockchain with progress bar
    SYNC_PROGRESS_BAR=$(
      if [ "$SYNCING_REPLACE_TX" -ge "995" ] &>/dev/null; then
        echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓ 100%\\r"
        WALLET_SYNC="100" # wallet blockchain is synced 100%
      else
        # something went wrong
        if [[ -z "$SYNCING_REPLACE_TX" ]] &>/dev/null; then
          echo -ne "     · · · · · · · · · · · · · · · · · · · · · · · · · · %\\r"
        fi
        # is less than 99
        if [ "$SYNCING_REPLACE_TX" -lt "10" ] &>/dev/null; then
          SYNC_PROGRESS_BAR="${N0:?}       Loading${N0:?}"
        fi
        # is equal to
        if [ "$SYNCING_REPLACE_TX" -ge "10" ] &>/dev/null; then
          echo -ne "     ▓·················································· 1%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "20" ] &>/dev/null; then
          echo -ne "     ▓▓················································· 2%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "30" ] &>/dev/null; then
          echo -ne "     ▓▓▓················································ 3%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "40" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓··············································· 4%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "50" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓·············································· 5%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "60" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓············································· 6%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "70" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓············································ 7%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "80" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓··········································· 8%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "90" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓·········································· 9%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "100" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓········································· 10%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "110" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓········································· 11%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "120" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓········································ 12%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "130" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓········································ 13%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "140" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓········································ 14%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "150" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓······································· 15%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "160" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓······································· 16%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "170" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓······································ 17%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "180" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓······································ 18%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "190" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓······································ 19%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "200" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓····································· 20%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "210" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓····································· 21%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "220" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓···································· 22%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "230" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓···································· 23%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "240" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓···································· 24%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "250" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓··································· 25%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "260" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓··································· 26%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "270" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓·································· 27%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "280" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓·································· 28%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "290" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓·································· 29%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "300" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓································· 30%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "310" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓································· 31%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "320" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓································ 32%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "330" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓································ 33%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "340" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓································ 34%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "350" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓······························· 35%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "360" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓······························· 36%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "370" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓······························ 37%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "380" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓······························ 38%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "390" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓······························ 39%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "400" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓····························· 40%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "410" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓····························· 41%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "420" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓···························· 42%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "430" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓···························· 43%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "440" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓···························· 44%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "450" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓··························· 45%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "460" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓··························· 46%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "470" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓·························· 47%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "480" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓·························· 48%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "490" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓·························· 49%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "500" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓························· 50%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "510" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓························· 51%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "520" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓························ 52%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "530" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓························ 53%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "540" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓························ 54%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "550" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓······················· 55%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "560" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓······················· 56%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "570" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓······················ 57%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "580" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓······················ 58%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "590" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓······················ 59%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "600" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓····················· 60%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "610" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓····················· 61%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "620" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓···················· 62%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "630" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓···················· 63%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "640" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓···················· 64%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "650" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓··················· 65%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "660" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓··················· 66%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "670" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓·················· 67%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "680" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓·················· 68%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "690" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓·················· 69%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "700" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓················· 70%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "710" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓················· 71%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "720" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓················ 72%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "730" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓················ 73%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "740" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓················ 74%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "750" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓··············· 75%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "760" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓··············· 76%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "770" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓·············· 77%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "780" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓·············· 78%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "790" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓·············· 79%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "800" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓············· 80%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "810" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓············· 81%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "820" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓············ 82%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "830" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓············ 83%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "840" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓············ 84%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "850" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓··········· 85%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "860" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓··········· 86%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "870" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓·········· 87%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "880" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓·········· 88%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "890" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓·········· 89%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "900" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓········· 90%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "910" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓········ 91%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "920" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓······· 92%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "930" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓······ 93%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "940" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓····· 94%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "950" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓···· 95%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "960" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓··· 96%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "970" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓·· 97%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "980" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓· 98%\\r"
        fi
        if [ "$SYNCING_REPLACE_TX" -ge "990" ] &>/dev/null; then
          echo -ne "     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓ 99%\\r"
        fi
        WALLET_TXLAST="$SYNCING_REPLACE_TX"
      fi
    )
    if [[ -z "$SYNC_PROGRESS_BAR" ]] &>/dev/null; then
      # non responsive
      SYNC_PROGRESS_BAR="${N0:?}       Loading${N0:?}"
    fi

    ### sync should be done ####################################################
  fi
fi

# END
